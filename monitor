　　0 引 言
　　近年来，随着信息社会的高速发展与进步，公共区域安全已经成为社会关注的重点话题之一。学校作为学生接受教育的学习场地，家长在关注师资力量与教学环境的同时，校园安全也越来越受到家长和社会的关注[1]。近几年发生的校园安全事件，如上海携程亲子园工作人员给幼儿喂芥末;贵州黎平七中一男生在宿舍遭人群殴等，使得校园安全置身于舆论的风口浪尖[2]。车站作为人们日常出行的必进之地，区域安全管理同样需要重点关注，广州火车站暴力袭击事件造成6人受伤。如何在不妨碍人们正常生活的同时，能够实现对区域的有效监控与安全管理，是监控系统的未来目标。
　　随着大数据与人工智能时代的到来，面对长期学生校园安全问题[3]，以及社会公共区域的监控和治理问题等，数字化的监控系统的出现，使得在不妨碍人们日常出行的情况下，实现对管理区域的有效且全面的监控，满足社会各界对安全的需要，同时解决了区域监控的效率问题，实现了高效、高识别率、大范围监控。
　　1 系统介绍
　　1.1 Django框架
　　Django是一种基于Python的开源Web框架。相较于传统的Web开发，开发过程中经常遇见开发进程缓慢、效率低下、数据库切换不友好等情况，Django在设计之初就考虑到相关问题。
　　如图1所示，Django框架采用模型（Model）-模板（Template）-视图（View）的MVC设计模式[4]。
　　（1）模型对应的是数据存取层，主要用于数据相关事务的处理。
　　（2）模板对应的是业务逻辑层，主要用于表现相关决定的处理。
　　（3）视图对应的是表现层，主要用于存取、调用模型及相应的逻辑。
　　业务逻辑层、前端视图层、数据模型层在Django中体现了高内聚低耦合的特性[5]，便于开发者的快速上手与使用。Django为了解决实际生产过程中可能使用到不同数据库的需求，采用ORM 对象关系映射，能够便捷地进行数据模型设计与交互，提供表单模型的同时还支持对原生SQL语句的运行，极大地提高了数据库的可选择性。
　　1.2 硬件
　　本系统的设计理念侧重于进出安防、校园边界监控和学生在校期间日常监控查询，摄像头与闸机的选取尤为重要。闸机有传统的单一刷卡闸机和新型的人脸识别闸机[6]。但由于应用场景的多变与危情不可预知的特点，闸机采用单一的人脸识别技术并不能完全切合实际情况的需求。本系统采用人脸识别和电子刷卡双重识别，既能满足学生进出高效，又确保进出身份安全认证。
　　2 系统设计
　　2.1 硬件选取
　　本系统闸机采用TD-Y002D型号翼闸搭配TD-P12型号的人脸识别一体机。闸机拥有3对红外防夹感应，双向读卡窗口，支持WiFi和4G模块，可直接通过管理计算机实现远程控制与管理。人脸识别一体机屏幕分辨率为1 024×600，拥有200万像素RGB摄像头，识别距离为0.5～4m。本系统采用海康威视iDS-2PT7T40MX（13～52 mm）系列摄像头。
　　2.2 软件
　　2.2.1 短信平台选择
　　国内三大运营商均提供短信服务，但是作为互联网平台，直接接入运营商进行短信发送，存在开发成本大、周期长、效率低等问题[7]。因此，选择已有的短信平台能够很好地满足中小型网站发送短信的需求，为便于后续系统部署与运维，本系统采用阿里云短信平台。通过开放阿里云短信功能权限AccessKeyID和AccessKeySecret等相关参数，调取阿里云短信API实现快速开发[8]。
　　2.2.2 数据库选择
　　数据库是信息存储的关键。MySQL是一种关系数据库管理系统，关系数据库将数据保存在不同的表中，而非放在一个大仓库内，增加了速度并提高了灵活性。MySQL作为开源数据库可供开发者使用，具有体积小、速度快、成本低等特点，因此本系统采用MySQL作为网站数据库。
　　2.2.3 项目部署
　　项目部署有两种方式：一種是本地部署包括搭建本地服务器，配置本地环境，配备服务器机房以及专用光纤以便于外网访问。此部署方式优点是数据独立、安全可靠，缺点是硬件和运维成本高、不便于后期维护。另一种是中小型网站最好的选择[9]，利用云计算，部署在云端的服务能够支持在线升级和扩展应用，弹性设置网络环境，根据不同需求与使用量合理安排云服务环境，极大地降低了运维和硬件成本。
　　2.3 系统模块
　　入园时，闸机进行人脸识别，进行数据打包并传输至云端，在云端服务器进行数据解析，完成图片解码，短信发送，Web服务调取摄像头API，实现远程视频监控。系统模块流程如图2所示。
　　3 系统实现
　　3.1 闸机人脸识别模块
　　线下统计包括家长姓名、家长电话、学生姓名、学生班级、学生照片等信息，录入数据库。本系统采用人物轨迹法[10]，学生进入校园时，闸机获取打卡学生姓名，人脸识别一体机抓取人脸图片，通过人脸对比，识别抓拍人物信息，通过相关信息进行索引，获取数据库预存信息。然后将获取信息按照固定格式封装成JSON格式数据，通过Http协议发送至云端服务器。 　　3.2 短信发送模块
　　在云端监控系统进行JSON解码，提取学生姓名、家长姓名、家长手机号、打卡时间等数据，以参数的形式传入阿里云短信API中，通过阿里云短信平台，发送至家长手机，实现学生入园信息的实时通知。如图3所示，短信数量和短信发送记录能够通过阿里云短信平台进行查询和监控。
　　3.3 图片解析模块
　　为提高识别效率，充分利用云计算优势，本系统的图片传输采用编码字符串的形式。图片抓取成功后进行两次编码：第一次进行Base64编码;第二次进行URL编码。Base64编码的作用在于减少Http请求，同时支持图片提前加载[11]，但是进行Base64编码以后产生的字符串也会带来特殊字符在传输过程中无法有效识别和产生歧义的问题。为了解决此问题，采用对Base64编码以后的字符串进行URL编码的二次编码，可有效避免由于特殊字符带来的问题[12]。
　　云端服务器接收数据帧，获取其中的图片编码字符串，首先进行URL解码，还原成Base64编码，再进行Base64解码，将解码数据写入JPG文件中，还原成图片进行人脸比对，同时将图片存储在云端服务器。
　　3.4 远程视频监控模块
　　云端监控系统调用摄像头API获取监控视频，同时部署在围墙边的传感器获取园区边界信息。当有人翻越围墙时传感器会出现高低电平变化，通过主控芯片将告警信息传输至监控平台[13]。同时，对监控视频进行图像处理，利用深度学习完成姿态识别，例如：监控范围内出现学生打架事件，弹出告警信息传输至监控平台。对园区出现的告警信息，系统会进行信息分类并记录日志。
　　3.5 系统实现流程
　　如图4所示，学生进入校园时，首先通过刷身份认证卡，同时面向人脸识别一体机，闸机识别刷卡身份信息，当符合预存信息则进行人脸识别，当识别成功后，闸机内置程序将相关数据打包成JSON，数据结构见表1所列，通过4G模块发送到云端[14]。
　　云端部署的Django框架服务器运行Http接口服务，接收硬件闸机发送的打卡数据，调用阿里云短信服务，实时发送打卡短信到家长手机号，短信内容包括打卡时间、打卡地点、打卡学生姓名。打卡学生实时抓取图片编码字符串首先通过URL解码，还原成Base64编码字符串，再通过Base64解码[15]，还原成JPG格式图片并保存到本地服务器。监控系统接入校园安全摄像头接口，实现远程监控园区安全和告警管理。
　　4 系统测试
　　幼儿园校园的安全问题是社会关注的重中之重。本系统测试试点选取珠海市某幼儿园。本系统部署运行之后，学生入园刷卡如图5所示，由一名学生刷卡通过闸机。
　　闸机准确进行人脸识别，并将学生信息按照规定好的数据帧发送至云端服务器[16]。云端准确接收并进行解析，完成短信发送，短信监控显示如图6所示。
　　系统中的数据存储、图片解析及抓拍图片还原存储如图7所示。
　　运行Web服务，调取监控视频API，如图8所示，实现对校园环境的实时监控，以及校园监控与告警。
　　5 结 语
　　数字化、网络化、智能化是视频监控发展的必然趋势。本系统实现了人脸识别、短信通知、园区边界及场内安全监控，综合性能显著优于传统监控系统。基于阿里云服务，本系统可根据幼儿园监控数量和家长用户数量实时调整服务器性能，保障视频流畅度和实时性。人工智能告警系统能及时将异常情况通知给管理者，从而实施有效的安全管控，最大程度保障学生安全，解除老师和家长的后顾之忧，创建平安校园。
